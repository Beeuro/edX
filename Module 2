	#Stock Market Analysis
Sub StockAnalysis()
    Dim ws As Worksheet
    Dim ticker As String
    Dim yearlyChange As Double
    Dim percentChange As Double
    Dim totalVolume As Double
    Dim lastRow As Long
    Dim summaryRow As Integer
    Dim startPrice As Double
    Dim endPrice As Double
    
    For Each ws In Worksheets
        summaryRow = 2
        totalVolume = 0
        startPrice = 0
        endPrice = 0
        
        ws.Cells(1, 9).Value = "Ticker"
        ws.Cells(1, 10).Value = "Yearly Change"
        ws.Cells(1, 11).Value = "Percent Change"
        ws.Cells(1, 12).Value = "Total Stock Volume"
        
        lastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row
        
        For i = 2 To lastRow
            If startPrice = 0 Then
                startPrice = ws.Cells(i, 3).Value
            End If
            
            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then
                ticker = ws.Cells(i, 1).Value
                endPrice = ws.Cells(i, 6).Value
                totalVolume = totalVolume + ws.Cells(i, 7).Value
                yearlyChange = endPrice - startPrice
                If startPrice <> 0 Then
                    percentChange = (yearlyChange / startPrice) * 100
                Else
                    percentChange = 0
                End If
                
                ws.Cells(summaryRow, 9).Value = ticker
                ws.Cells(summaryRow, 10).Value = yearlyChange
                ws.Cells(summaryRow, 11).Value = percentChange
                ws.Cells(summaryRow, 11).NumberFormat = "0.00%"
                ws.Cells(summaryRow, 12).Value = totalVolume
                
                If yearlyChange > 0 Then
                    ws.Cells(summaryRow, 10).Interior.ColorIndex = 4 'Green
                Else
                    ws.Cells(summaryRow, 10).Interior.ColorIndex = 3 'Red
                End If
                
                summaryRow = summaryRow + 1
                startPrice = 0
                totalVolume = 0
            Else
                totalVolume = totalVolume + ws.Cells(i, 7).Value
            End If
        Next i
        
        'Add code here to find "Greatest % increase", "Greatest % decrease", and "Greatest total volume"
        'This section will require additional logic to loop through the summary data you've created and identify these values.
        
    Next ws
    
End Sub

	#Requirements
Sub StockMarketAnalysis()
    Dim ws As Worksheet
    Dim ticker As String
    Dim openPrice As Double
    Dim closePrice As Double
    Dim yearlyChange As Double
    Dim percentChange As Double
    Dim totalVolume As Currency
    Dim summaryRow As Integer
    Dim lastRow As Long
    Dim startRow As Long
    
    Application.ScreenUpdating = False
    
    For Each ws In Worksheets
        lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
        summaryRow = 2
        totalVolume = 0
        startRow = 2
        
        ' Column Headers for Summary Table
        ws.Cells(1, 9).Value = "Ticker"
        ws.Cells(1, 10).Value = "Total Stock Volume"
        ws.Cells(1, 11).Value = "Yearly Change ($)"
        ws.Cells(1, 12).Value = "Percent Change"
        
        ' Find initial open price
        openPrice = ws.Cells(2, 3).Value
        
        For i = 2 To lastRow
            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then
                ticker = ws.Cells(i, 1).Value
                closePrice = ws.Cells(i, 6).Value
                yearlyChange = closePrice - openPrice
                totalVolume = totalVolume + ws.Cells(i, 7).Value
                
                If openPrice <> 0 Then
                    percentChange = yearlyChange / openPrice
                Else
                    percentChange = 0
                End If
                
                ' Print ticker, total volume, yearly change, and percent change
                With ws
                    .Cells(summaryRow, 9).Value = ticker
                    .Cells(summaryRow, 10).Value = totalVolume
                    .Cells(summaryRow, 11).Value = yearlyChange
                    .Cells(summaryRow, 12).Value = percentChange
                    .Cells(summaryRow, 12).NumberFormat = "0.00%"
                    
                    ' Conditional Formatting for Yearly Change
                    If yearlyChange > 0 Then
                        .Cells(summaryRow, 11).Interior.ColorIndex = 4 ' Green
                    Else
                        .Cells(summaryRow, 11).Interior.ColorIndex = 3 ' Red
                    End If
                End With
                
                summaryRow = summaryRow + 1
                totalVolume = 0
                If i + 1 <= lastRow Then
                    openPrice = ws.Cells(i + 1, 3).Value
                End If
            Else
                totalVolume = totalVolume + ws.Cells(i, 7).Value
            End If
        Next i
        
        ' Call a function/sub to calculate Greatest % Increase, Greatest % Decrease, and Greatest Total Volume
        Call CalculateSpecialValues(ws)
        
    Next ws
    
    Application.ScreenUpdating = True
End Sub

Sub CalculateSpecialValues(ws As Worksheet)
    Dim lastRow As Long
    lastRow = ws.Cells(ws.Rows.Count, 9).End(xlUp).Row
    
    Dim maxIncrease As Double
    Dim maxDecrease As Double
    Dim maxVolume As Currency
    Dim tickerIncrease As String
    Dim tickerDecrease As String
    Dim tickerVolume As String
    
    maxIncrease = 0
    maxDecrease = 0
    maxVolume = 0
    
    For i = 2 To lastRow
        If ws.Cells(i, 12).Value > maxIncrease Then
            maxIncrease = ws.Cells(i, 12).Value
            tickerIncrease = ws.Cells(i, 9).Value
        ElseIf ws.Cells(i, 12).Value < maxDecrease Then
            maxDecrease = ws.Cells(i, 12).Value
            tickerDecrease = ws.Cells(i, 9).Value
        End If
        
        If ws.Cells(i, 10).Value > maxVolume Then
            maxVolume = ws.Cells(i, 10).Value
            tickerVolume = ws.Cells(i, 9).Value
        End If
    Next i
    
    ' Adding to the worksheet
    ws.Cells(2, 14).Value = "Greatest % Increase"
    ws.Cells

Data visualization complete
